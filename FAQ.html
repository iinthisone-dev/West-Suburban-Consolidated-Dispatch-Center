<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAQ - West Suburban Consolidated Dispatch Center</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .admin-controls {
            display: inline-block;
            margin-left: 1rem;
        }
        .admin-controls button {
            padding: 0.5rem 1rem;
            margin-left: 0.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .edit-btn {
            background: #ffc107;
            color: #000;
        }
        .delete-btn {
            background: #dc3545;
            color: white;
        }
        .faq-item {
            position: relative;
        }
    </style>
</head>
<body>
    <nav class="main-nav">
        <div class="nav-brand">
            <img src="photos/wscdc_logo.png" alt="WSDC Logo" class="nav-logo">
        </div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="careers.html">Careers</a>
            <a href="FOIA.html">FOIA</a>
            <a href="FAQ.html" class="active">FAQ</a>
            <a href="links.html">Links</a>
            <a href="contact.html">Contact</a>
        </div>
        <div class="nav-auth">
            <button onclick="openModal('signinModal')" class="auth-btn signin-btn">
                <i class="fas fa-sign-in-alt"></i> Sign In
            </button>
            <button onclick="openModal('signupModal')" class="auth-btn signup-btn">
                <i class="fas fa-user-plus"></i> Sign Up
            </button>
        </div>
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-content">
            <h1>Frequently Asked Questions</h1>
            <p>Common questions about 9-1-1, how WSCDC operates, and how we serve the community.</p>
        </div>
    </header>

    <main>
        <section class="faq-section">
            <div class="container">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2>Questions & Answers</h2>
                    <button id="addFaqBtn" style="display: none;" class="cta-button" onclick="openFaqModal()">
                        <i class="fas fa-plus"></i> Add FAQ
                    </button>
                </div>

                <div id="faqContainer">
                    <div style="text-align: center; padding: 2rem; color: var(--navy);">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                        <p>Loading FAQs...</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="info-section">
            <div class="info-box">
                <h2>Mission Statement</h2>
                <p>To provide professional and compassionate 9-1-1 dispatch services in a fiscally responsible manner to the residents, visitors, and businesses of the communities served by the West Suburban Consolidated Dispatch Center.</p>
            </div>

            <div class="info-box">
                <h2>WSCDC History</h2>
                <p>The West Suburban Consolidated Dispatch Center (WSCDC) was formed in May of 2002 when the Oak Park and River Forest 9-1-1 dispatch centers merged. In 2004, the Village of Elmwood Park joined the center. In November of 2014, WSCDC began answering calls for service and dispatching the Park Ridge Police Department. In May of 2017 WSCDC began answering calls for service and dispatching for the Forest Park Police and Fire Department.</p>
            </div>

            <div class="info-box">
                <h2>Governance</h2>
                <p>WSCDC is compliant with Part 725 of Title 83 of the Illinois Administrative Code and is authorized to operate a 9-1-1 Emergency Telephone Number System and promote the awareness of the system to all potential users.</p>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Contact Us</h3>
                <p>Emergency: 911</p>
                <p>Non-Emergency: (708) 771-9110</p>
            </div>
            <div class="footer-section">
                <h3>Location</h3>
                <p>400 Park Avenue</p>
                <p>River Forest, IL 60305</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <a href="careers.html">Careers</a>
                <a href="meetings.html">Meetings</a>
                <a href="contact.html">Contact</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 West Suburban Consolidated Dispatch Center. All rights reserved.</p>
        </div>
    </footer>

    <!-- FAQ Modal -->
    <div id="faqModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeFaqModal()">&times;</span>
            <h2 id="faqModalTitle">Add FAQ</h2>
            <form id="faqForm" class="modal-form">
                <div class="form-group">
                    <label for="faq-question">Question *</label>
                    <input type="text" id="faq-question" required>
                </div>
                <div class="form-group">
                    <label for="faq-answer">Answer *</label>
                    <textarea id="faq-answer" rows="6" required></textarea>
                </div>
                <button type="submit" class="submit-btn">Save FAQ</button>
            </form>
        </div>
    </div>

    <!-- Sign In Modal -->
    <div id="signinModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('signinModal')">&times;</span>
            <h2>Sign In</h2>
            <form id="signinForm" class="modal-form">
                <div class="form-group">
                    <label for="signin-email">Email</label>
                    <input type="email" id="signin-email" required>
                </div>
                <div class="form-group">
                    <label for="signin-password">Password</label>
                    <input type="password" id="signin-password" required>
                </div>
                <button type="submit" class="submit-btn">Sign In</button>
            </form>
        </div>
    </div>

    <!-- Sign Up Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('signupModal')">&times;</span>
            <h2>Create Account</h2>
            <form id="signupForm" class="modal-form">
                <div class="form-group">
                    <label for="signup-name">Full Name</label>
                    <input type="text" id="signup-name" required>
                </div>
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" required>
                </div>
                <div class="form-group">
                    <label for="signup-phone">Phone Number</label>
                    <input type="tel" id="signup-phone" required>
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" required minlength="6">
                </div>
                <button type="submit" class="submit-btn">Sign Up</button>
            </form>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <!-- Initialize Firebase -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDzXZtNX_EsLxaNWQPc8o7rDoUg1Dpz5m4",
            authDomain: "wscdc-66d0e.firebaseapp.com",
            projectId: "wscdc-66d0e",
            storageBucket: "wscdc-66d0e.firebasestorage.app",
            messagingSenderId: "701584946154",
            appId: "1:701584946154:web:b11a9f7fe9009e2813f893",
            measurementId: "G-1CSTJ0PH10"
        };
        firebase.initializeApp(firebaseConfig);
        window.auth = firebase.auth();
        window.db = firebase.firestore();
    </script>

    <script src="app.js"></script>

    <script>
        let isAdmin = false;
        let editingFaqId = null;

        // Check if user is admin
        window.auth.onAuthStateChanged(async (user) => {
            if (user) {
                const userDoc = await window.db.collection('users').doc(user.uid).get();
                if (userDoc.exists && userDoc.data().role === 'admin') {
                    isAdmin = true;
                    document.getElementById('addFaqBtn').style.display = 'block';
                }
            }
            loadFAQs();
        });

        // Load FAQs from Firestore
        async function loadFAQs() {
            try {
                const snapshot = await window.db.collection('faqs').orderBy('createdAt', 'desc').get();
                const container = document.getElementById('faqContainer');
                
                if (snapshot.empty) {
                    container.innerHTML = '<p style="text-align: center; color: #666;">No FAQs available yet.</p>';
                    return;
                }

                container.innerHTML = '';
                snapshot.forEach(doc => {
                    const faq = doc.data();
                    const faqElement = document.createElement('div');
                    faqElement.className = 'faq-item';
                    faqElement.innerHTML = `
                        <h3>
                            ${faq.question}
                            ${isAdmin ? `
                                <span class="admin-controls">
                                    <button class="edit-btn" onclick="editFaq('${doc.id}', '${faq.question.replace(/'/g, "\\'")}', '${faq.answer.replace(/'/g, "\\'")}')">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="delete-btn" onclick="deleteFaq('${doc.id}')">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </span>
                            ` : ''}
                        </h3>
                        <p>${faq.answer}</p>
                    `;
                    container.appendChild(faqElement);
                });
            } catch (error) {
                console.error('Error loading FAQs:', error);
                document.getElementById('faqContainer').innerHTML = 
                    '<p style="color: red;">Error loading FAQs. Please try again later.</p>';
            }
        }

        // Open FAQ modal
        function openFaqModal() {
            document.getElementById('faqModal').style.display = 'block';
            document.getElementById('faqModalTitle').textContent = 'Add FAQ';
            document.getElementById('faqForm').reset();
            editingFaqId = null;
        }

        // Close FAQ modal
        function closeFaqModal() {
            document.getElementById('faqModal').style.display = 'none';
            editingFaqId = null;
        }

        // Edit FAQ
        function editFaq(id, question, answer) {
            editingFaqId = id;
            document.getElementById('faqModalTitle').textContent = 'Edit FAQ';
            document.getElementById('faq-question').value = question;
            document.getElementById('faq-answer').value = answer;
            document.getElementById('faqModal').style.display = 'block';
        }

        // Delete FAQ
        async function deleteFaq(id) {
            if (!confirm('Are you sure you want to delete this FAQ?')) return;
            
            try {
                await window.db.collection('faqs').doc(id).delete();
                alert('FAQ deleted successfully!');
                loadFAQs();
            } catch (error) {
                console.error('Error deleting FAQ:', error);
                alert('Error deleting FAQ: ' + error.message);
            }
        }

        // Handle FAQ form submission
        document.getElementById('faqForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const question = document.getElementById('faq-question').value;
            const answer = document.getElementById('faq-answer').value;

            try {
                if (editingFaqId) {
                    // Update existing FAQ
                    await window.db.collection('faqs').doc(editingFaqId).update({
                        question: question,
                        answer: answer,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('FAQ updated successfully!');
                } else {
                    // Add new FAQ
                    await window.db.collection('faqs').add({
                        question: question,
                        answer: answer,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('FAQ added successfully!');
                }
                
                closeFaqModal();
                loadFAQs();
            } catch (error) {
                console.error('Error saving FAQ:', error);
                alert('Error saving FAQ: ' + error.message);
            }
        });
    </script>
</body>
</html>
